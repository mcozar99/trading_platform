FROM ubuntu:18.04

# Install dependencies
RUN apt-get update && \
 apt-get -y install git && \
 apt-get -y install curl && \
 apt-get -y install python && \
 apt-get -y install python3-pip

# Clone project
RUN git clone https://github.com/mcozar99/trading_platform
WORKDIR trading_platform
RUN pip3 install -r requirements.txt

# Config.py
RUN touch config.py
RUN echo INFLUXDB_TOKEN = \"JhYnxYHwXJwXcCbg2G5Raw8k4pS8aS_mnfOGbnMeeyOdA6sZNvqRqryHGNugXxCRgo3OwrWvPTiRnGMO0K50Qg==\" >> config.py
WORKDIR visualization

# Runs the stream gatherer in a container and feeds InfluxDB
RUN chmod 777 server.py
RUN export FLASK_APP=server.py
EXPOSE 8080
CMD flask run --host=0.0.0.0 --port=8080